<?xml version="1.0"?><xliff version="1.2" xmlns="urn:oasis:names:tc:xliff:document:1.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xliff:document:1.2 xliff-core-1.2-transitional.xsd"><file datatype="xml" original="advanced-unattended-setup-scripting.md" source-language="en-US" target-language="en-US"><header><tool tool-id="mdxliff" tool-name="mdxliff" tool-version="1.0-89bd9eb" tool-company="Microsoft" /><xliffext:skl_file_name xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">153414c6-1165-44de-8a6b-bbd48721b1c62701d0d9af8427baa5c93524e9faaa2aaa5d75c4.skl</xliffext:skl_file_name><xliffext:version xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">1.2</xliffext:version><xliffext:ms.openlocfilehash xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">2701d0d9af8427baa5c93524e9faaa2aaa5d75c4</xliffext:ms.openlocfilehash><xliffext:ms.sourcegitcommit xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">153414c6-1165-44de-8a6b-bbd48721b1c6</xliffext:ms.sourcegitcommit><xliffext:ms.lasthandoff xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">07/23/2019</xliffext:ms.lasthandoff><xliffext:ms.openlocfilepath xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">source_WDG2\advanced-unattended-setup-scripting.md</xliffext:ms.openlocfilepath></header><body><group id="content" extype="content"><trans-unit id="101" translate="yes" xml:space="preserve" restype="x-metadata">
          <source>Advanced Unattended Setup Scripting</source>
        </trans-unit><trans-unit id="102" translate="yes" xml:space="preserve" restype="x-metadata">
          <source>Unattended setup scripting is a lightweight yet powerful automation technology that was introduced with the March 2017 XDK.</source>
        </trans-unit><trans-unit id="103" translate="yes" xml:space="preserve" restype="x-metadata">
          <source>This white paper provides several advanced scripting techniques to automate the settings and configuration for your devkits.</source>
        </trans-unit><trans-unit id="104" translate="yes" xml:space="preserve">
          <source>Advanced Unattended Setup Scripting</source>
        </trans-unit><trans-unit id="105" translate="yes" xml:space="preserve">
          <source><bpt id="p1">**</bpt>Advanced Technology Group (ATG) and Xbox Platform Engineering<ept id="p1">**</ept></source>
        </trans-unit><trans-unit id="106" translate="yes" xml:space="preserve">
          <source><bpt id="p1">*</bpt>Published October 2nd, 2017<ept id="p1">*</ept></source>
        </trans-unit><trans-unit id="107" translate="yes" xml:space="preserve">
          <source>In this topic</source>
        </trans-unit><trans-unit id="108" translate="yes" xml:space="preserve">
          <source><bpt id="p1">[</bpt>Introduction<ept id="p1">](#introduction)</ept></source>
        </trans-unit><trans-unit id="109" translate="yes" xml:space="preserve">
          <source><bpt id="p1">[</bpt>Dovetailing with other scripts and executables<ept id="p1">](#dovetailing-with-other-scripts-and-executables)</ept></source>
        </trans-unit><trans-unit id="110" translate="yes" xml:space="preserve">
          <source><bpt id="p1">[</bpt>Deploying a script to multiple consoles<ept id="p1">](#deploying-a-script-to-multiple-consoles)</ept></source>
        </trans-unit><trans-unit id="111" translate="yes" xml:space="preserve">
          <source><bpt id="p1">[</bpt>Unique host names<ept id="p1">](#unique-host-names)</ept></source>
        </trans-unit><trans-unit id="112" translate="yes" xml:space="preserve">
          <source><bpt id="p1">[</bpt>Unique test accounts<ept id="p1">](#unique-test-accounts)</ept></source>
        </trans-unit><trans-unit id="113" translate="yes" xml:space="preserve">
          <source><bpt id="p1">[</bpt>Recovery deployment<ept id="p1">](#recovery-deployment)</ept></source>
        </trans-unit><trans-unit id="114" translate="yes" xml:space="preserve">
          <source><bpt id="p1">[</bpt>Summary<ept id="p1">](#summary)</ept></source>
        </trans-unit><trans-unit id="115" translate="yes" xml:space="preserve">
          <source><bpt id="p1">[</bpt>References<ept id="p1">](#references)</ept></source>
        </trans-unit><trans-unit id="116" translate="yes" xml:space="preserve">
          <source>Introduction</source>
        </trans-unit><trans-unit id="117" translate="yes" xml:space="preserve">
          <source>Simple scripts are easy to author, but more complex automation problems require advanced techniques to solve.</source>
        </trans-unit><trans-unit id="118" translate="yes" xml:space="preserve">
          <source>This white paper covers advanced unattended setup scripting techniques, and applies them to solutions to several real-world automation tasks.</source>
        </trans-unit><trans-unit id="119" translate="yes" xml:space="preserve">
          <source>You should already be familiar with the basics of authoring unattended setup scripts.</source>
        </trans-unit><trans-unit id="120" translate="yes" xml:space="preserve">
          <source>For an introduction to unattended setup scripting and reference material, search the index of the <bpt id="p1">[</bpt>XDK Documentation<ept id="p1">](https://developer.microsoft.com/en-us/games/xbox/docs/xdk/unattended-setup-script)</ept> for “Configuring Your Dev Kit with an Unattended Setup Script” and the topics beneath it.</source>
        </trans-unit><trans-unit id="121" translate="yes" xml:space="preserve">
          <source>Dovetailing with other scripts and executables</source>
        </trans-unit><trans-unit id="122" translate="yes" xml:space="preserve">
          <source>If you’re already familiar with the basics of unattended setup script authoring, you’ve probably used the in-browser script authoring tool to create scripts by combining multiple scripting actions.</source>
        </trans-unit><trans-unit id="123" translate="yes" xml:space="preserve">
          <source>(Going forward, this paper will often refer to the unattended setup script authoring tool as the “in-browser” editor).</source>
        </trans-unit><trans-unit id="124" translate="yes" xml:space="preserve">
          <source>However, the in-browser editor doesn’t provide the full flexibility that you’d get by simply authoring scripts in a standard text editor.</source>
        </trans-unit><trans-unit id="125" translate="yes" xml:space="preserve">
          <source>If you’re already proficient at writing batch files, this section will show you how to leverage your scripting skills to extend the capabilities of a script originally created in the unattended setup script editor.</source>
        </trans-unit><trans-unit id="126" translate="yes" xml:space="preserve">
          <source>If you export a script from the in-browser editor and then open it in a standard text editor, you’ll see that it’s really just an ordinary batch file; it just adds a few commenting conventions to enable reordering actions in the in-browser editor.</source>
        </trans-unit><trans-unit id="127" translate="yes" xml:space="preserve">
          <source>For example, this excerpt shows the actual batch-file code generated for the <bpt id="p1">**</bpt>Set the host name for the console<ept id="p1">**</ept> action.</source>
        </trans-unit><trans-unit id="128" translate="yes" xml:space="preserve">
          <source>Notice that the script block is delimited with specific comments: “REM SCRIPTSTEP START HOSTNAME V1” and “REM SCRIPTSTEP STOP”.</source>
        </trans-unit><trans-unit id="129" translate="yes" xml:space="preserve">
          <source>There are also a few other conventions that you’ll have to preserve for the script to be valid in the in-browser editor.</source>
        </trans-unit><trans-unit id="130" translate="yes" xml:space="preserve">
          <source>If you don’t follow these conventions, you may encounter errors when you try to import the script into the in-browser editor.</source>
        </trans-unit><trans-unit id="131" translate="yes" xml:space="preserve">
          <source>For this reason, we strongly recommend that you don’t hand-edit your scripts extensively.</source>
        </trans-unit><trans-unit id="132" translate="yes" xml:space="preserve">
          <source>Here’s an example of a <bpt id="p1">**</bpt>Do custom action<ept id="p1">**</ept> script block.</source>
        </trans-unit><trans-unit id="133" translate="yes" xml:space="preserve">
          <source>The line: “<ph id="ph1">@echo</ph> this is a test” is the text entered into the browser, whereas the rest was automatically generated by the editor.</source>
        </trans-unit><trans-unit id="134" translate="yes" xml:space="preserve">
          <source>You can replace this line with your own batch file commands and the results should still be valid for importing into the in-browser editor.</source>
        </trans-unit><trans-unit id="135" translate="yes" xml:space="preserve">
          <source>Note that the in-browser editor also lets you type several lines of input.</source>
        </trans-unit><trans-unit id="136" translate="yes" xml:space="preserve">
          <source><bpt id="p1">**</bpt>Run another script<ept id="p1">**</ept> is the most flexible way to apply your batch scripting skills.</source>
        </trans-unit><trans-unit id="137" translate="yes" xml:space="preserve">
          <source>You can simply put your custom batch file code into your own file and then call into it.</source>
        </trans-unit><trans-unit id="138" translate="yes" xml:space="preserve">
          <source>For example, if you have a script called “SetupLogFiles.cmd” and you want to pass in arguments “Player.log” and “AI.log”, you’d fill in the details as shown.</source>
        </trans-unit><trans-unit id="139" translate="yes" xml:space="preserve">
          <source><bpt id="p1">**</bpt>Figure 1. Details for “Run another script” action.<ept id="p1">**</ept></source>
        </trans-unit><trans-unit id="140" translate="yes" xml:space="preserve">
          <source>The dialog provides a hint about how you might deploy the auxiliary script (that is, by using a USB drive).</source>
        </trans-unit><trans-unit id="141" translate="yes" xml:space="preserve">
          <source>But the deployment method you choose deserves some further explanation because it will affect the details for the <bpt id="p1">**</bpt>Run another script<ept id="p1">**</ept> action.</source>
        </trans-unit><trans-unit id="142" translate="yes" xml:space="preserve">
          <source>Possible options for deploying the auxiliary script are as follows:</source>
        </trans-unit><trans-unit id="143" translate="yes" xml:space="preserve">
          <source>Copy the auxiliary script to a network share.</source>
        </trans-unit><trans-unit id="144" translate="yes" xml:space="preserve">
          <source>This is the most powerful configuration, because it lets you leverage the auxiliary script on multiple consoles.</source>
        </trans-unit><trans-unit id="145" translate="yes" xml:space="preserve">
          <source>This way, you can put the bulk of your custom scripting into auxiliary batch files on a network share and then call those scripts from your other unattended setup scripts.</source>
        </trans-unit><trans-unit id="146" translate="yes" xml:space="preserve">
          <source>When you place your script on a network share, you need to refer to it using a UNC path:</source>
        </trans-unit><trans-unit id="147" translate="yes" xml:space="preserve">
          <source>Place the auxiliary script on the same external drive as your unattended setup script.</source>
        </trans-unit><trans-unit id="148" translate="yes" xml:space="preserve">
          <source>In this scenario, you are attaching an external drive before commencing the OOBE, or factory reset, on the devkit.</source>
        </trans-unit><trans-unit id="149" translate="yes" xml:space="preserve">
          <source>After the setup is complete, the system will run the unattended setup script on the external storage device (as described previously).</source>
        </trans-unit><trans-unit id="150" translate="yes" xml:space="preserve">
          <source>When the system runs a script from an external drive, it passes the drive root as a command-line parameter to the script.</source>
        </trans-unit><trans-unit id="151" translate="yes" xml:space="preserve">
          <source>Within the script, a variable called <bpt id="p1">**</bpt>%UsbRoot%<ept id="p1">**</ept> is defined by means of the same value.</source>
        </trans-unit><trans-unit id="152" translate="yes" xml:space="preserve">
          <source>Further, the drive root is also added to the <bpt id="p1">**</bpt>%PATH%<ept id="p1">**</ept> variable and you’ll be able to reference your script by using a path relative to the root of the external drive.</source>
        </trans-unit><trans-unit id="153" translate="yes" xml:space="preserve">
          <source>Copy the script to a known location on the devkit.</source>
        </trans-unit><trans-unit id="154" translate="yes" xml:space="preserve">
          <source>The system will add a folder, d:\boot, to the <bpt id="p1">**</bpt>%PATH%<ept id="p1">**</ept> variable before running the script.</source>
        </trans-unit><trans-unit id="155" translate="yes" xml:space="preserve">
          <source>This means that you can place your scripts in d:\boot and then simply reference them by name.</source>
        </trans-unit><trans-unit id="156" translate="yes" xml:space="preserve">
          <source>Alternatively, if they’re anywhere on the d: drive, you can specify a path relative to d:\boot.</source>
        </trans-unit><trans-unit id="157" translate="yes" xml:space="preserve">
          <source>Another option is simply to use a fully qualified path, such as d:\boot\MyScript.cmd.</source>
        </trans-unit><trans-unit id="158" translate="yes" xml:space="preserve">
          <source>Traditionally, batch files are often used as the glue to combine together multiple tools that are implemented as stand-alone executables.</source>
        </trans-unit><trans-unit id="159" translate="yes" xml:space="preserve">
          <source>Since unattended setup scripts are actually just batch files, we provided the <bpt id="p1">**</bpt>Run an executable<ept id="p1">**</ept> action.</source>
        </trans-unit><trans-unit id="160" translate="yes" xml:space="preserve">
          <source>To use the <bpt id="p1">**</bpt>Run an executable<ept id="p1">**</ept> action, provide an executable name and zero or more optional arguments.</source>
        </trans-unit><trans-unit id="161" translate="yes" xml:space="preserve">
          <source>The executable name is subject to the same guidelines as the path to the auxiliary script when you use <bpt id="p1">**</bpt>Run another script<ept id="p1">**</ept>.</source>
        </trans-unit><trans-unit id="162" translate="yes" xml:space="preserve">
          <source>To illustrate how to use <bpt id="p1">**</bpt>Run an executable<ept id="p1">**</ept>, here’s a concrete example that uses a tool named wduser.exe, which conveniently is already included in the %PATH% on the devkit.</source>
        </trans-unit><trans-unit id="163" translate="yes" xml:space="preserve">
          <source>Because wduser.exe is already in the path, you simply provide the executable file name to use the tool.</source>
        </trans-unit><trans-unit id="164" translate="yes" xml:space="preserve">
          <source><bpt id="p1">**</bpt>Figure 2. Details for “Run an executable” action.<ept id="p1">**</ept></source>
        </trans-unit><trans-unit id="165" translate="yes" xml:space="preserve">
          <source>The example shows how to get the help information from wduser.exe by providing ‘/?’</source>
        </trans-unit><trans-unit id="166" translate="yes" xml:space="preserve">
          <source>as the argument.</source>
        </trans-unit><trans-unit id="167" translate="yes" xml:space="preserve">
          <source>When you test this, you’ll see the command line help information in the output window of the in-browser editor:</source>
        </trans-unit><trans-unit id="168" translate="yes" xml:space="preserve">
          <source>This works because wduser.exe can be reached by way of the <bpt id="p1">**</bpt>%PATH%<ept id="p1">**</ept> variable.</source>
        </trans-unit><trans-unit id="169" translate="yes" xml:space="preserve">
          <source>(If you want to know the search path, simply add a <bpt id="p1">**</bpt>Do custom action<ept id="p1">**</ept> action and provide <bpt id="p2">**</bpt><ph id="ph1">@echo</ph> %PATH%<ept id="p2">**</ept>)</source>
        </trans-unit><trans-unit id="170" translate="yes" xml:space="preserve">
          <source>The following figure shows a complete example of a script that would sign in a gold member user account and then add a guest account using wduser addsponsored.</source>
        </trans-unit><trans-unit id="171" translate="yes" xml:space="preserve">
          <source><bpt id="p1">**</bpt>Figure 3. Example of a “Run an executable” action<ept id="p1">**</ept></source>
        </trans-unit><trans-unit id="172" translate="yes" xml:space="preserve">
          <source>Here are the specific details for the <bpt id="p1">**</bpt>Run an executable<ept id="p1">**</ept> action.</source>
        </trans-unit><trans-unit id="173" translate="yes" xml:space="preserve">
          <source><bpt id="p1">**</bpt>Figure 3. Action details.<ept id="p1">**</ept></source>
        </trans-unit><trans-unit id="174" translate="yes" xml:space="preserve">
          <source>Deploying a script to multiple consoles</source>
        </trans-unit><trans-unit id="175" translate="yes" xml:space="preserve">
          <source>In a lab setting, it quickly becomes onerous to deploy the same script to every devkit.</source>
        </trans-unit><trans-unit id="176" translate="yes" xml:space="preserve">
          <source>This section discusses some strategies that you can use to automate script deployment.</source>
        </trans-unit><trans-unit id="177" translate="yes" xml:space="preserve">
          <source>We’ll consider two types of script:</source>
        </trans-unit><trans-unit id="178" translate="yes" xml:space="preserve">
          <source>A script intended to run immediately following the out-of-box experience (OOBE) or factory reset.</source>
        </trans-unit><trans-unit id="179" translate="yes" xml:space="preserve">
          <source>—or—</source>
        </trans-unit><trans-unit id="180" translate="yes" xml:space="preserve">
          <source>Other script types such as a startup/boot script or a quick-action script.</source>
        </trans-unit><trans-unit id="181" translate="yes" xml:space="preserve">
          <source>Unattended setup script for OOBE or factory reset</source>
        </trans-unit><trans-unit id="182" translate="yes" xml:space="preserve">
          <source>The out-of-box experience (OOBE) is that first thing that runs on a new devkit when you power it on after taking it out of the packaging.</source>
        </trans-unit><trans-unit id="183" translate="yes" xml:space="preserve">
          <source>On a console that has already been set up previously, you can force a factory reset to run the same OOBE experience again.</source>
        </trans-unit><trans-unit id="184" translate="yes" xml:space="preserve">
          <source>Regardless of how you invoke OOBE, after it finishes, the file system on the devkit is completely clean and there’s no reasonable way to have a custom script on the internal HDD.</source>
        </trans-unit><trans-unit id="185" translate="yes" xml:space="preserve">
          <source>So for the OOBE or factory reset scenario, you are limited to using an external storage device.</source>
        </trans-unit><trans-unit id="186" translate="yes" xml:space="preserve">
          <source>During OOBE, the system downloads the recovery from the cloud.</source>
        </trans-unit><trans-unit id="187" translate="yes" xml:space="preserve">
          <source>However, there’s also a method for performing an “offline system update”.</source>
        </trans-unit><trans-unit id="188" translate="yes" xml:space="preserve">
          <source>To do this, on the USB drive, you must create a $systemupdate folder that contains the update files.</source>
        </trans-unit><trans-unit id="189" translate="yes" xml:space="preserve">
          <source>Instructions can be found at <bpt id="p1">[</bpt>Xbox One Offline System Update<ept id="p1">](https://support.xbox.com/en-US/xbox-one/console/system-updates-solution)</ept>.</source>
        </trans-unit><trans-unit id="190" translate="yes" xml:space="preserve">
          <source>Regardless of whether you’re using an offline system update or a just relying on the OOBE behavior to get the update online, you can still provide a script to run after the update finishes, by deploying that script to the external storage device.</source>
        </trans-unit><trans-unit id="191" translate="yes" xml:space="preserve">
          <source>Export the script from the in-browser editor, name it “oobe.cmd”, and then copy it to the root of the USB drive.</source>
        </trans-unit><trans-unit id="192" translate="yes" xml:space="preserve">
          <source>Boot script or quick-action script</source>
        </trans-unit><trans-unit id="193" translate="yes" xml:space="preserve">
          <source>Boot scripts and quick-action scripts typically reside on the internal hard drive of the devkit.</source>
        </trans-unit><trans-unit id="194" translate="yes" xml:space="preserve">
          <source>(A boot script can also reside on an external storage device.) When developing a script, you can simply use the in-browser editor to deploy the script to a single console.</source>
        </trans-unit><trans-unit id="195" translate="yes" xml:space="preserve">
          <source>If you want to deploy the same script to several devkits, you’ll likely want an automated approach.</source>
        </trans-unit><trans-unit id="196" translate="yes" xml:space="preserve">
          <source>One solution is to write a batch file like this to deploy and run the script on all of the devkits.</source>
        </trans-unit><trans-unit id="197" translate="yes" xml:space="preserve">
          <source>To make this work, you must provide:</source>
        </trans-unit><trans-unit id="198" translate="yes" xml:space="preserve">
          <source>An unattended setup script called:</source>
        </trans-unit><trans-unit id="199" translate="yes" xml:space="preserve">
          <source>A file containing a list of the devkits that you want to update.</source>
        </trans-unit><trans-unit id="200" translate="yes" xml:space="preserve">
          <source>The file must be named:</source>
        </trans-unit><trans-unit id="201" translate="yes" xml:space="preserve">
          <source>Each line of the file will have either a host name or IP address for a devkit in the group.</source>
        </trans-unit><trans-unit id="202" translate="yes" xml:space="preserve">
          <source>Then run the batch-file from the Xbox One command prompt.</source>
        </trans-unit><trans-unit id="203" translate="yes" xml:space="preserve">
          <source>Here’s a concrete example:</source>
        </trans-unit><trans-unit id="204" translate="yes" xml:space="preserve">
          <source>The example assumes that the batch file is named DeployAndReboot.cmd and works on a hypothetical group called “PlayTestLab”.</source>
        </trans-unit><trans-unit id="205" translate="yes" xml:space="preserve">
          <source>As described above, you’d need two files:</source>
        </trans-unit><trans-unit id="206" translate="yes" xml:space="preserve">
          <source>consoles.PlayTestLab.txt</source>
        </trans-unit><trans-unit id="207" translate="yes" xml:space="preserve">
          <source>SetupDevkit.PlayTestLab.xboxunattend</source>
        </trans-unit><trans-unit id="208" translate="yes" xml:space="preserve">
          <source>Discovering consoles</source>
        </trans-unit><trans-unit id="209" translate="yes" xml:space="preserve">
          <source>The DeployAndReboot.cmd batch file is a convenient way to deploy your boot script to a group of consoles, but only after you have created the list of host names or IPs.</source>
        </trans-unit><trans-unit id="210" translate="yes" xml:space="preserve">
          <source>Creating the list in the first place could be a daunting task if you have a lab or studio filled with devkits that may not all be set up consistently.</source>
        </trans-unit><trans-unit id="211" translate="yes" xml:space="preserve">
          <source>The xbConnect.exe utility supports a /<bpt id="p1">**</bpt>discover<ept id="p1">**</ept> option that allows you to list the running devkits on your local network.</source>
        </trans-unit><trans-unit id="212" translate="yes" xml:space="preserve">
          <source>Here’s a batch file that runs xbConnect to enumerate your devkits.</source>
        </trans-unit><trans-unit id="213" translate="yes" xml:space="preserve">
          <source>The batch file is benign—it merely gathers information, and this is a deliberate design choice.</source>
        </trans-unit><trans-unit id="214" translate="yes" xml:space="preserve">
          <source>Be sure to review the list of devkits that you obtain before performing a destructive change on all those consoles.</source>
        </trans-unit><trans-unit id="215" translate="yes" xml:space="preserve">
          <source>Otherwise, you could end up causing a lot of disruption in your studio.</source>
        </trans-unit><trans-unit id="216" translate="yes" xml:space="preserve">
          <source>As a best practice, use extreme caution when using the results of xbConnect /<bpt id="p1">**</bpt>discover<ept id="p1">**</ept> in a script.</source>
        </trans-unit><trans-unit id="217" translate="yes" xml:space="preserve">
          <source>It’s always a best practice to set an access key on your devkit.</source>
        </trans-unit><trans-unit id="218" translate="yes" xml:space="preserve">
          <source>This prevents people who may have access to your network from also accessing your devkit.</source>
        </trans-unit><trans-unit id="219" translate="yes" xml:space="preserve">
          <source>You can set the same access key for all the devkits that you want to manage as a group.</source>
        </trans-unit><trans-unit id="220" translate="yes" xml:space="preserve">
          <source>You can find the <bpt id="p1">**</bpt>Access Key<ept id="p1">**</ept> setting in Dev Home.</source>
        </trans-unit><trans-unit id="221" translate="yes" xml:space="preserve">
          <source>Alternatively, you can use xbConfig.exe to change the <bpt id="p1">**</bpt>Access Key<ept id="p1">**</ept> setting.</source>
        </trans-unit><trans-unit id="222" translate="yes" xml:space="preserve">
          <source><bpt id="p1">**</bpt>Figure 4. Access Key Setting in Dev Home.<ept id="p1">**</ept></source>
        </trans-unit><trans-unit id="223" translate="yes" xml:space="preserve">
          <source>The access key restricts access by tools from the Xbox One command prompt, but doesn’t restrict access when connecting via Xbox Device Portal.</source>
        </trans-unit><trans-unit id="224" translate="yes" xml:space="preserve">
          <source>To restrict access for Xbox Device Portal, configure the Remote Access settings in Dev Home.</source>
        </trans-unit><trans-unit id="225" translate="yes" xml:space="preserve">
          <source>For more information, search the index of the <bpt id="p1">[</bpt>XDK Documentation<ept id="p1">](https://developer.microsoft.com/en-us/games/xbox/docs/xdk/windows-device-portal-on-xbox)</ept> for “Xbox Device Portal”.</source>
        </trans-unit><trans-unit id="226" translate="yes" xml:space="preserve">
          <source>How to avoid deploying</source>
        </trans-unit><trans-unit id="227" translate="yes" xml:space="preserve">
          <source>The best way to deploy the same script to several devkits is not to do it at all.</source>
        </trans-unit><trans-unit id="228" translate="yes" xml:space="preserve">
          <source>You can deploy a simple boot script just once to all your devkits, and that script then uses the <bpt id="p1">**</bpt>Run another script<ept id="p1">**</ept> action to call a script that resides on a network share.</source>
        </trans-unit><trans-unit id="229" translate="yes" xml:space="preserve">
          <source>After that, you can concentrate most of your scripting actions in the remote script on the network share.</source>
        </trans-unit><trans-unit id="230" translate="yes" xml:space="preserve">
          <source>Whenever you make changes to the remote script, those changes are automatically picked up when the boot script on any of your devkits runs the remote script.</source>
        </trans-unit><trans-unit id="231" translate="yes" xml:space="preserve">
          <source>Unique host names</source>
        </trans-unit><trans-unit id="232" translate="yes" xml:space="preserve">
          <source>Setting the host name on a group of devkits programmatically presents a challenge because you must use a different host name for each devkit.</source>
        </trans-unit><trans-unit id="233" translate="yes" xml:space="preserve">
          <source>The default <bpt id="p1">**</bpt>Set the host name for the console<ept id="p1">**</ept> action uses a simple mechanism to accomplish this.</source>
        </trans-unit><trans-unit id="234" translate="yes" xml:space="preserve">
          <source>Each time an unattended script runs, the following parameters are passed in.</source>
        </trans-unit><trans-unit id="235" translate="yes" xml:space="preserve">
          <source>Recall that the unattended action named <bpt id="p1">**</bpt>Set the host name for the console<ept id="p1">**</ept> has an optional check box that lets you automatically generate the host name in the form <bpt id="p2">**</bpt>XB<ept id="p2">**</ept><ph id="ph1">-</ph><ph id="ph2">\&lt;</ph>console serial number&gt; (for example, XB-001234567890).</source>
        </trans-unit><trans-unit id="236" translate="yes" xml:space="preserve">
          <source>The standard script block for the <bpt id="p1">**</bpt>Set the host name<ept id="p1">**</ept>…</source>
        </trans-unit><trans-unit id="237" translate="yes" xml:space="preserve">
          <source>action composes <bpt id="p1">**</bpt>%SerialNumber%<ept id="p1">**</ept> with a string fragment to create the host name.</source>
        </trans-unit><trans-unit id="238" translate="yes" xml:space="preserve">
          <source>The default host-name scheme does indeed give you unique host names, but the names are not user friendly.</source>
        </trans-unit><trans-unit id="239" translate="yes" xml:space="preserve">
          <source>Here’s a script that takes a different approach.</source>
        </trans-unit><trans-unit id="240" translate="yes" xml:space="preserve">
          <source>Rather than use the <bpt id="p1">**</bpt>%SerialNumber%<ept id="p1">**</ept> to generate the host name, this script just uses some logic to “look up” a friendlier host name that is associated with each serial number.</source>
        </trans-unit><trans-unit id="241" translate="yes" xml:space="preserve">
          <source>You can use this script on multiple consoles, provided that you include the serial numbers for each within the script.</source>
        </trans-unit><trans-unit id="242" translate="yes" xml:space="preserve">
          <source>Unique test accounts</source>
        </trans-unit><trans-unit id="243" translate="yes" xml:space="preserve">
          <source>The trick in the unique host name example is to use the <bpt id="p1">**</bpt>%SerialNumber%<ept id="p1">**</ept> as a key to look up a value (for example, the host name) that is associated with that serial number.</source>
        </trans-unit><trans-unit id="244" translate="yes" xml:space="preserve">
          <source>A test account is analogous to a host name, in that you want a unique test account signed in on each individual devkit.</source>
        </trans-unit><trans-unit id="245" translate="yes" xml:space="preserve">
          <source>You can use the same technique as with host names to sign in unique test accounts on several consoles.</source>
        </trans-unit><trans-unit id="246" translate="yes" xml:space="preserve">
          <source>To do this, you add a custom action that looks like this.</source>
        </trans-unit><trans-unit id="247" translate="yes" xml:space="preserve">
          <source>Notice that the script uses <bpt id="p1">**</bpt>!XblEmailAddress!<ept id="p1">**</ept></source>
        </trans-unit><trans-unit id="248" translate="yes" xml:space="preserve">
          <source>instead of <bpt id="p1">**</bpt>%XblEmailAddress%<ept id="p1">**</ept>.</source>
        </trans-unit><trans-unit id="249" translate="yes" xml:space="preserve">
          <source>The ‘!’</source>
        </trans-unit><trans-unit id="250" translate="yes" xml:space="preserve">
          <source>variable delimiter is valid only when you have “delayed expansion” enabled for batch files.</source>
        </trans-unit><trans-unit id="251" translate="yes" xml:space="preserve">
          <source>To enable delayed expansion, add “SETLOCAL EnableDelayedExpansion” somewhere near the beginning of your script.</source>
        </trans-unit><trans-unit id="252" translate="yes" xml:space="preserve">
          <source>Scripts that you create with the unattended setup script editor will always enable delayed expansion.</source>
        </trans-unit><trans-unit id="253" translate="yes" xml:space="preserve">
          <source>In this example, each of the test accounts has the same password, which is why the <bpt id="p1">**</bpt>XblPassword<ept id="p1">**</ept> value is the same in all cases.</source>
        </trans-unit><trans-unit id="254" translate="yes" xml:space="preserve">
          <source>Also, the password is base64 encoded.</source>
        </trans-unit><trans-unit id="255" translate="yes" xml:space="preserve">
          <source>Base64 encoding is used to support special characters in the password.</source>
        </trans-unit><trans-unit id="256" translate="yes" xml:space="preserve">
          <source>The base64 encoding is used only as a convenient way to encode special characters and is not a secure way to store passwords.</source>
        </trans-unit><trans-unit id="257" translate="yes" xml:space="preserve">
          <source>To get a base64-encoded password value, you can use the script editor.</source>
        </trans-unit><trans-unit id="258" translate="yes" xml:space="preserve">
          <source>First, supply user credentials as shown.</source>
        </trans-unit><trans-unit id="259" translate="yes" xml:space="preserve">
          <source><bpt id="p1">**</bpt>Figure 5. Sign-in details.<ept id="p1">**</ept></source>
        </trans-unit><trans-unit id="260" translate="yes" xml:space="preserve">
          <source>Next, export the script and open the resulting file in your favorite editor.</source>
        </trans-unit><trans-unit id="261" translate="yes" xml:space="preserve">
          <source>Then look for the encoded password (search for “XblPassword”), which you can now substitute into your own custom script.</source>
        </trans-unit><trans-unit id="262" translate="yes" xml:space="preserve">
          <source>Recovery deployment</source>
        </trans-unit><trans-unit id="263" translate="yes" xml:space="preserve">
          <source>Follow these steps to stage and deploy a new Xbox One recovery update to a group of consoles:</source>
        </trans-unit><trans-unit id="264" translate="yes" xml:space="preserve">
          <source>Download and unpack the .zip file for the Xbox One recovery update of your choice from <ph id="ph1">https://developer.microsoft.com/en-us/games/xbox/partner/development-downloads-xdk-archives</ph></source>
        </trans-unit><trans-unit id="265" translate="yes" xml:space="preserve">
          <source>Place the unpacked payload on a network share.</source>
        </trans-unit><trans-unit id="266" translate="yes" xml:space="preserve">
          <source>(For a brief example of how to set up a network share, search the index of the <bpt id="p1">[</bpt>XDK Documentation<ept id="p1">](https://developer.microsoft.com/en-us/games/xbox/docs/xdk/pc-deployment)</ept> for “Run from PC Deployment”.)</source>
        </trans-unit><trans-unit id="267" translate="yes" xml:space="preserve">
          <source>Create an unattended script with at least the following two script actions:</source>
        </trans-unit><trans-unit id="268" translate="yes" xml:space="preserve">
          <source><bpt id="p1">**</bpt>Add network credentials<ept id="p1">**</ept></source>
        </trans-unit><trans-unit id="269" translate="yes" xml:space="preserve">
          <source><bpt id="p1">**</bpt>Update console OS recovery<ept id="p1">**</ept></source>
        </trans-unit><trans-unit id="270" translate="yes" xml:space="preserve">
          <source>Deploy and run the unattended script on each console that you want to update with the new Xbox One recovery update.</source>
        </trans-unit><trans-unit id="271" translate="yes" xml:space="preserve">
          <source>In step 4, you can use the strategy described in <bpt id="p1">[</bpt>How to avoid deploying<ept id="p1">](#how-to-avoid-deploying)</ept> if you need to run the recovery update on a group of consoles.</source>
        </trans-unit><trans-unit id="272" translate="yes" xml:space="preserve">
          <source>Also, the script action <bpt id="p1">**</bpt>Update console OS recovery<ept id="p1">**</ept> does nothing at all in the case when the specified recovery is the same version as the recovery already installed on the devkit.</source>
        </trans-unit><trans-unit id="273" translate="yes" xml:space="preserve">
          <source>This makes it easy to add the script action to a boot script, because you know that it will update the recovery only when you have a newer one posted to your network share.</source>
        </trans-unit><trans-unit id="274" translate="yes" xml:space="preserve">
          <source>Summary</source>
        </trans-unit><trans-unit id="275" translate="yes" xml:space="preserve">
          <source>Unattended setup scripting is at first glance a very basic automation feature that you can extend by using your batch file programming prowess.</source>
        </trans-unit><trans-unit id="276" translate="yes" xml:space="preserve">
          <source>You can inject small pieces of functionality into your unattended script by using custom actions, or build up a sophisticated scripting infrastructure by calling out to your custom batch files.</source>
        </trans-unit><trans-unit id="277" translate="yes" xml:space="preserve">
          <source>Many studios need to manage a large number of devkits.</source>
        </trans-unit><trans-unit id="278" translate="yes" xml:space="preserve">
          <source>We’ve seen how to construct a system for deploying scripts to multiple consoles.</source>
        </trans-unit><trans-unit id="279" translate="yes" xml:space="preserve">
          <source>We’ve also discussed a scripting strategy that minimizes the need to deploy scripts frequently.</source>
        </trans-unit><trans-unit id="280" translate="yes" xml:space="preserve">
          <source>References</source>
        </trans-unit><trans-unit id="281" translate="yes" xml:space="preserve">
          <source>For more information about topics mentioned in this white paper, search the index of the <bpt id="p1">[</bpt>XDK Documentation<ept id="p1">](https://developer.microsoft.com/en-us/games/xbox/docs/xdk/index)</ept> for:</source>
        </trans-unit><trans-unit id="282" translate="yes" xml:space="preserve">
          <source>onfiguring Your Dev Kit with an Unattended Setup Script</source>
        </trans-unit><trans-unit id="283" translate="yes" xml:space="preserve">
          <source>Unattended Setup Scripting Quick Start Guide</source>
        </trans-unit><trans-unit id="284" translate="yes" xml:space="preserve">
          <source>Script Authoring Tool</source>
        </trans-unit><trans-unit id="285" translate="yes" xml:space="preserve">
          <source>Unattended Setup Script Reference</source>
        </trans-unit><trans-unit id="286" translate="yes" xml:space="preserve">
          <source>Xbox Device Portal</source>
        </trans-unit><trans-unit id="287" translate="yes" xml:space="preserve">
          <source>Run from PC Deployment</source>
        </trans-unit></group></body></file></xliff>